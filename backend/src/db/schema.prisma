datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// modelos
model habits {
  id            String   @id @default(auto()) @map("_id") @db.ObjectId
  name          String  
  category      Categoria 
  default_color String 
  default_hour  String
  programmable  Boolean
}

model tips {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  habit_id  String   @db.ObjectId
  tips      String[]

  @@map("habit-tips")
}

model instructions {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  category    CategoriaInstructions
  instruction String
}

model calendar {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  habit_id  String? @db.ObjectId
  user_id   String @db.ObjectId
  date      DateTime
  done      Boolean?
  type      TipoEvento
  schedule  Json? 

  @@map("calendar-events")
}

model diary {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  user_id   String   @db.ObjectId
  date      DateTime
  text      String
  mood      Mood
}

model units {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  habit_id  String   @db.ObjectId
  unit      Unidad
  goals      Json

  @@map("habits-units")
}

model users {
  id        String  @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  email     String  @unique
  date_born DateTime
  username  String  @unique
}

model userHabits {
  id                String  @id @default(auto()) @map("_id") @db.ObjectId
  habit_id          String  @db.ObjectId
  user_id           String  @db.ObjectId
  habit_user_type   TipoHabito 
  status            EstadoHabito
  current_streak    Int
  best_streak       Int
  times_forged      Int
  times_forged_goal Int
  settings          Json // TODO: Validar este json antes de guardarlo en bd (Middleware o en backend)

  @@map("habits-user")
}

// enums
enum Categoria {
  SaludFisica
  SaludMental
  Alimentacion
}

enum CategoriaInstructions {
  Inicio
  MisHabitos
  Diario
  Calendario
}

enum TipoEvento {
  Habito
  Evento
}

enum Mood {
  Bueno
  Normal
  Mal
}

enum Unidad {
  VecesAlDia
  Litros
  Pasos
  Minutos
}

enum TipoHabito {
  Desarrollo
  Mantenimiento
  Cese
}

enum EstadoHabito {
  SinIniciar
  EnProceso
  Forjado
  Interiorizado
}
